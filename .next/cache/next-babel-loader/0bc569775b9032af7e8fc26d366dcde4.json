{"ast":null,"code":"import db from '../connect/db';\nexport default {\n  getTopUsers: async callback => {\n    const q = 'SELECT users.*, services.service, services.photo_url FROM users JOIN users_services ON users_services.user_id = users.user_id JOIN services ON users_services.service_id = services.service_id where (rating > 4.7)';\n    db.query(q, (err, results) => {\n      if (err) {\n        console.log('err! stop it right there');\n        callback(err, null);\n      } else {\n        callback(null, results.rows);\n      }\n    });\n  },\n  getInitialPageLoad: async callback => {\n    const send = {\n      topUsers: null,\n      services: null\n    };\n\n    try {\n      const q1 = 'SELECT users.*, services.service, services.photo_url FROM users JOIN users_services ON users_services.user_id = users.user_id JOIN services ON users_services.service_id = services.service_id where (rating > 4.7)';\n      const q2 = 'SELECT * FROM services';\n      const firstCall = await db.query(q1);\n      send.topUsers = firstCall.rows;\n      const secondCall = await db.query(q2);\n      send.services = secondCall.rows;\n      callback(null, send);\n    } catch (e) {\n      callback(e, null);\n    }\n  }\n};","map":{"version":3,"sources":["/Users/derekvelzy/sta/database/model/model.ts"],"names":["db","getTopUsers","callback","q","query","err","results","console","log","rows","getInitialPageLoad","send","topUsers","services","q1","q2","firstCall","secondCall","e"],"mappings":"AAAA,OAAOA,EAAP,MAAe,eAAf;AA+BA,eAAe;AACbC,EAAAA,WAAW,EAAE,MAAOC,QAAP,IAA8B;AACzC,UAAMC,CAAC,GAAG,qNAAV;AACAH,IAAAA,EAAE,CAACI,KAAH,CAASD,CAAT,EAAY,CAACE,GAAD,EAAaC,OAAb,KAA8B;AACxC,UAAID,GAAJ,EAAS;AACPE,QAAAA,OAAO,CAACC,GAAR,CAAY,0BAAZ;AACAN,QAAAA,QAAQ,CAACG,GAAD,EAAM,IAAN,CAAR;AACD,OAHD,MAGO;AACLH,QAAAA,QAAQ,CAAC,IAAD,EAAOI,OAAO,CAACG,IAAf,CAAR;AACD;AACF,KAPD;AAQD,GAXY;AAabC,EAAAA,kBAAkB,EAAE,MAAOR,QAAP,IAA8B;AAChD,UAAMS,IAAc,GAAG;AAACC,MAAAA,QAAQ,EAAE,IAAX;AAAiBC,MAAAA,QAAQ,EAAE;AAA3B,KAAvB;;AACA,QAAI;AACF,YAAMC,EAAE,GAAG,qNAAX;AACA,YAAMC,EAAE,GAAG,wBAAX;AACA,YAAMC,SAAS,GAAG,MAAMhB,EAAE,CAACI,KAAH,CAASU,EAAT,CAAxB;AACAH,MAAAA,IAAI,CAACC,QAAL,GAAgBI,SAAS,CAACP,IAA1B;AACA,YAAMQ,UAAU,GAAG,MAAMjB,EAAE,CAACI,KAAH,CAASW,EAAT,CAAzB;AACAJ,MAAAA,IAAI,CAACE,QAAL,GAAgBI,UAAU,CAACR,IAA3B;AACAP,MAAAA,QAAQ,CAAC,IAAD,EAAOS,IAAP,CAAR;AACD,KARD,CAQE,OAAOO,CAAP,EAAU;AACVhB,MAAAA,QAAQ,CAACgB,CAAD,EAAI,IAAJ,CAAR;AACD;AACF;AA1BY,CAAf","sourcesContent":["import db from '../connect/db';\n\nexport interface Top {\n  user_id: Number;\n  username: String;\n  first: String;\n  last: String;\n  photo: String;\n  mech: Boolean;\n  rating: String;\n  location: String;\n  service: String;\n  photo_url: String;\n}\n\nexport interface Service {\n  service_id: Number;\n  service: String;\n  photo_url: String;\n}\n\nexport interface Combined {\n  topUsers: Top[];\n  services: Service[];\n}\n\ninterface Callback {\n  (err: Error, result?: undefined | null): void;\n  (err: undefined | null, result: Top[]): void;\n}\n\nexport default {\n  getTopUsers: async (callback: Callback) => {\n    const q = 'SELECT users.*, services.service, services.photo_url FROM users JOIN users_services ON users_services.user_id = users.user_id JOIN services ON users_services.service_id = services.service_id where (rating > 4.7)';\n    db.query(q, (err: Error, results: any) => {\n      if (err) {\n        console.log('err! stop it right there')\n        callback(err, null);\n      } else {\n        callback(null, results.rows);\n      }\n    })\n  },\n\n  getInitialPageLoad: async (callback: Callback) => {\n    const send: Combined = {topUsers: null, services: null};\n    try {\n      const q1 = 'SELECT users.*, services.service, services.photo_url FROM users JOIN users_services ON users_services.user_id = users.user_id JOIN services ON users_services.service_id = services.service_id where (rating > 4.7)';\n      const q2 = 'SELECT * FROM services';\n      const firstCall = await db.query(q1);\n      send.topUsers = firstCall.rows;\n      const secondCall = await db.query(q2);\n      send.services = secondCall.rows;\n      callback(null, send);\n    } catch (e) {\n      callback(e, null);\n    }\n  }\n};\n"]},"metadata":{},"sourceType":"module"}